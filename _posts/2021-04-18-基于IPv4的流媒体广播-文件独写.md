基于IPv4的流媒体广播

# 文件独写

I/O 操作： stdio 标准io；sysio 系统io

​				标准io依赖系统io，不同的系统有不同接口，标准io进行规范统一；

​				使用上，优先使用标准io，标准io会合并系统调用，做一定优化

​				eg:标准fopen： Linux下位open，win下为openfile



stdio:

- [ ] fopen(),fclose()                                                       打开关闭文件
- [ ] fgetc(),fputc(),fgets(),fputs(),fread(),fwrite()       读写操作
- [ ] printf(),scanf()                                                         输入输出
- [ ] fseek(),ftell(),rewind()                                            文件位置指针
- [ ] fflush()                                                                     合并系统调用



## 1.fopen

手册：fopen, fdopen, freopen - stream open functions

```c++
NAME
       fopen, fdopen, freopen - stream open functions
SYNOPSIS
       #include <stdio.h>
       FILE *fopen(const char *path, const char *mode);
RETURN VALUE
       Upon successful completion fopen(), fdopen() and freopen() return a FILE pointer.  Otherwise, NULL is returned  and  errno
       is set to indicate the error.
```
其中const修饰: 使用过程中，我不会改变*path 或 *mode的内容

------

拓展 errno

最开始为全局变量-->目前是一个宏

具体：私有化数据，保证没有冲突，把当前出错内容映射到当前地址空间

具体定义在：

```c++
klaus@ubuntu:~$ vim /usr/include/asm-generic/errno-base.h 
#ifndef _ASM_GENERIC_ERRNO_BASE_H
#define _ASM_GENERIC_ERRNO_BASE_H

#define EPERM            1      /* Operation not permitted */
#define ENOENT           2      /* No such file or directory */
#define ESRCH            3      /* No such process */
#define EINTR            4      /* Interrupted system call */
#define EIO              5      /* I/O error */
#define ENXIO            6      /* No such device or address */
#define E2BIG            7      /* Argument list too long */
#define ENOEXEC          8      /* Exec format error */
#define EBADF            9      /* Bad file number */
#define ECHILD          10      /* No child processes */
#define EAGAIN          11      /* Try again */
#define ENOMEM          12      /* Out of memory */
#define EACCES          13      /* Permission denied */
#define EFAULT          14      /* Bad address */
#define ENOTBLK         15      /* Block device required */
#define EBUSY           16      /* Device or resource busy */
#define EEXIST          17      /* File exists */
#define EXDEV           18      /* Cross-device link */
#define ENODEV          19      /* No such device */
#define ENOTDIR         20      /* Not a directory */
#define EISDIR          21      /* Is a directory */
#define EINVAL          22      /* Invalid argument */
#define ENFILE          23      /* File table overflow */
#define EMFILE          24      /* Too many open files */
#define ENOTTY          25      /* Not a typewriter */
#define ETXTBSY         26      /* Text file busy */
#define EFBIG           27      /* File too large */
#define ENOSPC          28      /* No space left on device */
#define ESPIPE          29      /* Illegal seek */
#define EROFS           30      /* Read-only file system */
#define EMLINK          31      /* Too many links */
#define EPIPE           32      /* Broken pipe */
#define EDOM            33      /* Math argument out of domain of func */
#define ERANGE          34      /* Math result not representable */
```

示例：fopen

```c++
klaus@ubuntu:~/Desktop/linx_c/IO$ cat fopen.c 
#include<stdio.h>
#include<stdlib.h>
#include <errno.h>

int main()
{
    FILE *fp;
    fp = fopen("tmp.txt","r+");
    if(fp == NULL)
    {
        fprintf(stderr,"fopen() failed! errno = %d\n", errno);
        exit(1);
    }
    puts("ok!");
    exit(0);
    }
klaus@ubuntu:~/Desktop/linx_c/IO$ ./fopen 
fopen() failed! errno = 2
```
改进errno成error message ---- perror,void perror(const char *s)

```c++
//fprintf(stderr,"fopen() failed!       errno = %d\n", errno);
perror("fopen()");

klaus@ubuntu:~/Desktop/linx_c/IO$ ./fopen 
fopen(): No such file or directory
```
perror可以自动关联全局变量errno，另外为strerror,char *strerror(int errnum)

```c++
//fprintf(stderr,"fopen() failed!       errno = %d\n", errno);
//perror("fopen()");
fprintf(stderr,"fopen(): %s\n",strerror(errno));

klaus@ubuntu:~/Desktop/linx_c/IO$ ./fopen 
fopen(): No such file or directory
```
------

mode参数

![image-20210418202131693](C:/Users/h/Desktop/github%E9%9B%86%E5%90%88/klauscf.github.io/images/image-20210418202131693.png)

